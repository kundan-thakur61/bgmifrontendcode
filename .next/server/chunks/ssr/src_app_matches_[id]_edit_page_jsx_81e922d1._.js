module.exports=[41002,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(38246),f=a.i(29338),g=a.i(536),h=a.i(21351),i=a.i(6327);function j(){let a=(0,d.useParams)(),j=(0,d.useRouter)(),{user:k,isAuthenticated:l,loading:m}=(0,f.useAuth)(),[n,o]=(0,c.useState)(null),[p,q]=(0,c.useState)(!0),[r,s]=(0,c.useState)(!1),[t,u]=(0,c.useState)(""),[v,w]=(0,c.useState)(""),[x,y]=(0,c.useState)({title:"",description:"",entryFee:"",prizePool:"",perKillPrize:"",maxSlots:"",scheduledAt:"",rules:[]});(0,c.useEffect)(()=>{m||z()},[a.id,m]);let z=async()=>{try{let b=(await g.api.getMatch(a.id)).match;o(b);let c=b.createdBy?._id||b.createdBy?.id||b.createdBy,d=k?.id||k?._id,e=c===d||c?.toString()===d?.toString(),f=k?.role&&["admin","super_admin","match_manager"].includes(k.role);if(!e&&!f)return void u("You do not have permission to edit this match");if(!["upcoming","registration_open"].includes(b.status))return void u("This match cannot be edited anymore");y({title:b.title||"",description:b.description||"",entryFee:b.entryFee?.toString()||"0",prizePool:b.prizePool?.toString()||"0",perKillPrize:b.perKillPrize?.toString()||"0",maxSlots:b.maxSlots?.toString()||"2",scheduledAt:b.scheduledAt?new Date(b.scheduledAt).toISOString().slice(0,16):"",rules:b.rules||[]})}catch(a){u("Match not found")}finally{q(!1)}},A=a=>{let{name:b,value:c}=a.target;y(a=>({...a,[b]:c}))},B=()=>{y(a=>({...a,rules:[...a.rules,""]}))},C=async b=>{b.preventDefault(),u(""),w(""),s(!0);try{let b={title:x.title,description:x.description,entryFee:parseInt(x.entryFee)||0,prizePool:parseInt(x.prizePool)||0,perKillPrize:parseInt(x.perKillPrize)||0,scheduledAt:new Date(x.scheduledAt).toISOString(),rules:x.rules.filter(a=>""!==a.trim())};1>=(n.filledSlots||n.joinedUsers?.length||0)&&(b.maxSlots=parseInt(x.maxSlots)||2),await g.api.updateUserMatch(a.id,b),w("Match updated successfully!"),setTimeout(()=>{j.push(`/matches/${a.id}`)},1500)}catch(a){u(a.message||"Failed to update match")}finally{s(!1)}};if(p||m)return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(h.default,{}),(0,b.jsx)("div",{className:"min-h-screen bg-dark-900 flex items-center justify-center",children:(0,b.jsx)("div",{className:"w-12 h-12 border-4 border-primary-500 border-t-transparent rounded-full animate-spin"})})]});if(!l)return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(h.default,{}),(0,b.jsx)("div",{className:"min-h-screen bg-dark-900 flex items-center justify-center",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("h1",{className:"text-2xl font-bold text-red-400 mb-4",children:"Please log in to edit matches"}),(0,b.jsx)(e.default,{href:"/login",className:"btn-primary",children:"Go to Login"})]})})]});if(t&&!n)return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(h.default,{}),(0,b.jsx)("div",{className:"min-h-screen bg-dark-900 flex items-center justify-center",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("h1",{className:"text-2xl font-bold text-red-400 mb-4",children:t}),(0,b.jsx)(e.default,{href:"/matches",className:"btn-primary",children:"Back to Matches"})]})})]});let D=1>=(n?.filledSlots||n?.joinedUsers?.length||0);return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(h.default,{}),(0,b.jsx)("main",{className:"min-h-screen bg-dark-900 py-8",children:(0,b.jsxs)("div",{className:"container mx-auto px-4 max-w-2xl",children:[(0,b.jsxs)(e.default,{href:`/matches/${a.id}`,className:"inline-flex items-center text-dark-400 hover:text-white mb-6",children:[(0,b.jsx)("svg",{className:"w-5 h-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Back to Match"]}),(0,b.jsxs)("div",{className:"mb-8",children:[(0,b.jsx)("h1",{className:"text-3xl font-bold mb-2",children:"Edit Match"}),(0,b.jsx)("p",{className:"text-dark-400",children:"Update your match details"})]}),t&&(0,b.jsx)("div",{className:"mb-6 p-4 bg-red-500/10 border border-red-500/30 text-red-400 rounded-xl",children:t}),v&&(0,b.jsx)("div",{className:"mb-6 p-4 bg-green-500/10 border border-green-500/30 text-green-400 rounded-xl",children:v}),(0,b.jsxs)("form",{onSubmit:C,className:"space-y-6",children:[(0,b.jsxs)("div",{className:"card p-6",children:[(0,b.jsxs)("h2",{className:"text-xl font-bold mb-4 flex items-center gap-2",children:[(0,b.jsx)("span",{children:"ðŸ“"})," Basic Information"]}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("label",{className:"block text-sm font-medium text-dark-300 mb-2",children:["Title ",(0,b.jsx)("span",{className:"text-red-400",children:"*"})]}),(0,b.jsx)("input",{type:"text",name:"title",value:x.title,onChange:A,required:!0,className:"input w-full",placeholder:"Match title"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-dark-300 mb-2",children:"Description"}),(0,b.jsx)("textarea",{name:"description",value:x.description,onChange:A,rows:3,className:"input w-full",placeholder:"Match description (optional)"})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("label",{className:"block text-sm font-medium text-dark-300 mb-2",children:["Scheduled Time ",(0,b.jsx)("span",{className:"text-red-400",children:"*"})]}),(0,b.jsx)("input",{type:"datetime-local",name:"scheduledAt",value:x.scheduledAt,onChange:A,required:!0,className:"input w-full"})]})]})]}),(0,b.jsxs)("div",{className:"card p-6",children:[(0,b.jsxs)("h2",{className:"text-xl font-bold mb-4 flex items-center gap-2",children:[(0,b.jsx)("span",{children:"ðŸ’°"})," Pricing"]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-dark-300 mb-2",children:"Entry Fee (â‚¹)"}),(0,b.jsx)("input",{type:"number",name:"entryFee",value:x.entryFee,onChange:A,min:"0",className:"input w-full"}),(0,b.jsx)("p",{className:"text-xs text-dark-500 mt-1",children:"What opponents pay to join"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-dark-300 mb-2",children:"Prize Pool (â‚¹)"}),(0,b.jsx)("input",{type:"number",name:"prizePool",value:x.prizePool,onChange:A,min:"0",className:"input w-full",disabled:!0}),(0,b.jsx)("p",{className:"text-xs text-yellow-500 mt-1",children:"âš ï¸ Prize pool cannot be changed"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-dark-300 mb-2",children:"Per Kill Prize (â‚¹)"}),(0,b.jsx)("input",{type:"number",name:"perKillPrize",value:x.perKillPrize,onChange:A,min:"0",className:"input w-full"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-dark-300 mb-2",children:"Max Players"}),(0,b.jsxs)("select",{name:"maxSlots",value:x.maxSlots,onChange:A,disabled:!D,className:"input w-full",children:[(0,b.jsx)("option",{value:"2",children:"1v1 (2 players)"}),(0,b.jsx)("option",{value:"4",children:"2v2 (4 players)"}),(0,b.jsx)("option",{value:"8",children:"4v4 (8 players)"})]}),!D&&(0,b.jsx)("p",{className:"text-xs text-yellow-500 mt-1",children:"âš ï¸ Cannot change - players have joined"})]})]})]}),(0,b.jsxs)("div",{className:"card p-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,b.jsxs)("h2",{className:"text-xl font-bold flex items-center gap-2",children:[(0,b.jsx)("span",{children:"ðŸ“œ"})," Match Rules"]}),(0,b.jsx)("button",{type:"button",onClick:B,className:"px-3 py-1 bg-primary-500/20 text-primary-400 rounded-lg text-sm hover:bg-primary-500/30 transition-all",children:"+ Add Rule"})]}),0===x.rules.length?(0,b.jsxs)("div",{className:"text-center py-8 border-2 border-dashed border-dark-600 rounded-xl",children:[(0,b.jsx)("p",{className:"text-dark-400 mb-2",children:"No rules added"}),(0,b.jsx)("button",{type:"button",onClick:B,className:"text-primary-400 hover:text-primary-300",children:"Add your first rule"})]}):(0,b.jsx)("div",{className:"space-y-3",children:x.rules.map((a,c)=>(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("span",{className:"w-8 h-8 bg-primary-500/20 rounded-lg flex items-center justify-center text-primary-400 text-sm font-bold shrink-0",children:c+1}),(0,b.jsx)("input",{type:"text",value:a,onChange:a=>{var b;let d;return b=a.target.value,void((d=[...x.rules])[c]=b,y(a=>({...a,rules:d})))},className:"input flex-1",placeholder:`Rule ${c+1}`}),(0,b.jsx)("button",{type:"button",onClick:()=>{let a;return a=x.rules.filter((a,b)=>b!==c),void y(b=>({...b,rules:a}))},className:"w-8 h-8 bg-red-500/20 text-red-400 rounded-lg hover:bg-red-500/30 transition-all flex items-center justify-center shrink-0",children:"Ã—"})]},c))})]}),(0,b.jsxs)("div",{className:"flex gap-4",children:[(0,b.jsx)(e.default,{href:`/matches/${a.id}`,className:"flex-1 py-3 bg-dark-700 hover:bg-dark-600 text-white rounded-xl font-semibold transition-all text-center",children:"Cancel"}),(0,b.jsx)("button",{type:"submit",disabled:r,className:"flex-1 py-3 bg-primary-500 hover:bg-primary-600 text-white rounded-xl font-semibold transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:r?"Saving...":"Save Changes"})]})]})]})}),(0,b.jsx)(i.default,{})]})}a.s(["default",()=>j])}];

//# sourceMappingURL=src_app_matches_%5Bid%5D_edit_page_jsx_81e922d1._.js.map