{"version":3,"sources":["../../../../src/app/matches/%5Bid%5D/page.jsx","../../../../src/components/matches/MatchChat.jsx"],"sourcesContent":["'use client';\r\n\r\nimport { useState, useEffect } from 'react';\r\nimport { useParams, useRouter } from 'next/navigation';\r\nimport Link from 'next/link';\r\nimport { useAuth } from '@/context/AuthContext';\r\nimport { api } from '@/lib/api';\r\nimport Navbar from '@/components/layout/Navbar';\r\nimport Footer from '@/components/layout/Footer';\r\nimport MatchChat from '@/components/matches/MatchChat';\r\n\r\nexport default function MatchDetailPage() {\r\n  const params = useParams();\r\n  const router = useRouter();\r\n  const { user, isAuthenticated } = useAuth();\r\n  const [match, setMatch] = useState(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [joining, setJoining] = useState(false);\r\n  const [error, setError] = useState('');\r\n  const [joinForm, setJoinForm] = useState({ inGameId: '', inGameName: '' });\r\n  const [showJoinModal, setShowJoinModal] = useState(false);\r\n  const [myStatus, setMyStatus] = useState(null);\r\n  const [roomCredentials, setRoomCredentials] = useState(null);\r\n  const [copied, setCopied] = useState('');\r\n\r\n  useEffect(() => {\r\n    fetchMatch();\r\n  }, [params.id]);\r\n\r\n  useEffect(() => {\r\n    if (isAuthenticated && match) {\r\n      fetchMyStatus();\r\n    }\r\n  }, [isAuthenticated, match]);\r\n\r\n  const fetchMatch = async () => {\r\n    try {\r\n      const data = await api.getMatch(params.id);\r\n      setMatch(data.match);\r\n    } catch (err) {\r\n      setError('Match not found');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const fetchMyStatus = async () => {\r\n    try {\r\n      const data = await api.getMyMatchStatus(params.id);\r\n      setMyStatus(data);\r\n      // Fetch room credentials if joined\r\n      if (data?.joined || data?.isJoined) {\r\n        if (data?.roomId) {\r\n          setRoomCredentials({\r\n            roomId: data.roomId,\r\n            roomPassword: data.roomPassword,\r\n            scheduledAt: data.scheduledAt\r\n          });\r\n        } else {\r\n          fetchRoomCredentials();\r\n        }\r\n      }\r\n    } catch (err) {\r\n      // Not joined\r\n    }\r\n  };\r\n\r\n  const fetchRoomCredentials = async () => {\r\n    try {\r\n      const data = await api.getRoomCredentials(params.id);\r\n      setRoomCredentials(data);\r\n    } catch (err) {\r\n      // Credentials not available yet\r\n    }\r\n  };\r\n\r\n  const copyToClipboard = (text, field) => {\r\n    navigator.clipboard.writeText(text);\r\n    setCopied(field);\r\n    setTimeout(() => setCopied(''), 2000);\r\n  };\r\n\r\n  const handleJoin = async (e) => {\r\n    e.preventDefault();\r\n    if (!isAuthenticated) {\r\n      router.push('/login');\r\n      return;\r\n    }\r\n\r\n    setJoining(true);\r\n    setError('');\r\n    try {\r\n      await api.joinMatch(params.id, joinForm.inGameId, joinForm.inGameName);\r\n      setShowJoinModal(false);\r\n      fetchMatch();\r\n      fetchMyStatus();\r\n    } catch (err) {\r\n      // Extract error message from axios response\r\n      const errorMessage = err.response?.data?.message || err.message || 'Failed to join match';\r\n      setError(errorMessage);\r\n    } finally {\r\n      setJoining(false);\r\n    }\r\n  };\r\n\r\n  const handleLeave = async () => {\r\n    if (!confirm('Are you sure you want to leave this match?')) return;\r\n\r\n    try {\r\n      await api.leaveMatch(params.id);\r\n      fetchMatch();\r\n      setMyStatus(null);\r\n    } catch (err) {\r\n      setError(err.message);\r\n    }\r\n  };\r\n\r\n  const handleCancelChallenge = async () => {\r\n    if (!confirm('Are you sure you want to cancel this challenge? Your creation fee and prize pool will be refunded to your wallet.')) return;\r\n\r\n    try {\r\n      const result = await api.cancelUserMatch(params.id);\r\n      alert(`Challenge cancelled! ‚Çπ${result.refund.total} has been refunded to your wallet.`);\r\n      router.push('/matches');\r\n    } catch (err) {\r\n      setError(err.message);\r\n    }\r\n  };\r\n\r\n  const getStatusBadge = (status) => {\r\n    const badges = {\r\n      upcoming: 'bg-blue-500/20 text-blue-400',\r\n      live: 'bg-green-500/20 text-green-400 animate-pulse',\r\n      completed: 'bg-dark-600 text-dark-300',\r\n      cancelled: 'bg-red-500/20 text-red-400',\r\n    };\r\n    return badges[status] || badges.upcoming;\r\n  };\r\n\r\n  if (loading) {\r\n    return (\r\n      <>\r\n        <Navbar />\r\n        <div className=\"min-h-screen bg-dark-900 flex items-center justify-center\">\r\n          <div className=\"w-12 h-12 border-4 border-primary-500 border-t-transparent rounded-full animate-spin\"></div>\r\n        </div>\r\n      </>\r\n    );\r\n  }\r\n\r\n  if (error && !match) {\r\n    return (\r\n      <>\r\n        <Navbar />\r\n        <div className=\"min-h-screen bg-dark-900 flex items-center justify-center\">\r\n          <div className=\"text-center\">\r\n            <h1 className=\"text-2xl font-bold text-red-400 mb-4\">{error}</h1>\r\n            <Link href=\"/matches\" className=\"btn-primary\">Back to Matches</Link>\r\n          </div>\r\n        </div>\r\n      </>\r\n    );\r\n  }\r\n\r\n  const isJoined = myStatus?.joined || myStatus?.isJoined;\r\n  const slotsLeft = match.maxSlots - (match.filledSlots || match.joinedUsers?.length || 0);\r\n  const isFull = slotsLeft <= 0;\r\n  const isCreator = user && (match.createdBy?._id === user.id || match.createdBy?._id === user._id || match.createdBy === user.id || match.createdBy === user._id);\r\n  const canCancel = isCreator && match.isChallenge && ['upcoming', 'registration_open'].includes(match.status) && (match.filledSlots || match.joinedUsers?.length || 0) <= 1;\r\n\r\n  return (\r\n    <>\r\n      <Navbar />\r\n      <main className=\"min-h-screen bg-dark-900 py-8\">\r\n        <div className=\"container mx-auto px-4 max-w-4xl\">\r\n          {/* Back Button */}\r\n          <Link href=\"/matches\" className=\"inline-flex items-center text-dark-400 hover:text-white mb-6\">\r\n            <svg className=\"w-5 h-5 mr-2\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15 19l-7-7 7-7\" />\r\n            </svg>\r\n            Back to Matches\r\n          </Link>\r\n\r\n          {/* Match Header */}\r\n          <div className=\"card p-6 mb-6 relative\">\r\n            {/* Challenge Badge */}\r\n            {match.isChallenge && (\r\n              <div className=\"absolute top-0 right-0 bg-linear-to-r from-gaming-purple to-gaming-orange text-white text-sm font-bold px-4 py-2 rounded-bl-lg rounded-tr-lg\">\r\n                üéØ CHALLENGE MATCH\r\n              </div>\r\n            )}\r\n\r\n            <div className=\"flex justify-between items-start mb-4\">\r\n              <div>\r\n                <span className={`inline-block px-3 py-1 rounded-full text-xs font-medium mb-2 ${getStatusBadge(match.status)}`}>\r\n                  {match.status.toUpperCase()}\r\n                </span>\r\n                <h1 className=\"text-2xl md:text-3xl font-bold\">{match.title}</h1>\r\n                {match.isChallenge && (\r\n                  <p className=\"text-gaming-orange text-sm mt-1\">\r\n                    Created by a player ‚Ä¢ Winner takes the prize pool!\r\n                  </p>\r\n                )}\r\n              </div>\r\n              <div className=\"text-right\">\r\n                <div className=\"text-3xl font-bold text-gaming-green\">‚Çπ{match.prizePool}</div>\r\n                <div className=\"text-dark-400 text-sm\">Prize Pool</div>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4 mt-6\">\r\n              <div className=\"bg-dark-700/50 rounded-lg p-4 text-center\">\r\n                <div className=\"text-dark-400 text-sm\">Entry Fee</div>\r\n                <div className=\"text-xl font-bold\">{match.entryFee === 0 ? 'FREE' : `‚Çπ${match.entryFee}`}</div>\r\n              </div>\r\n              <div className=\"bg-dark-700/50 rounded-lg p-4 text-center\">\r\n                <div className=\"text-dark-400 text-sm\">Mode</div>\r\n                <div className=\"text-xl font-bold capitalize\">{match.mode}</div>\r\n              </div>\r\n              <div className=\"bg-dark-700/50 rounded-lg p-4 text-center\">\r\n                <div className=\"text-dark-400 text-sm\">Slots</div>\r\n                <div className=\"text-xl font-bold\">{match.filledSlots || match.joinedUsers?.length || 0}/{match.maxSlots}</div>\r\n              </div>\r\n              <div className=\"bg-dark-700/50 rounded-lg p-4 text-center\">\r\n                <div className=\"text-dark-400 text-sm\">Map</div>\r\n                <div className=\"text-xl font-bold capitalize\">{match.map || 'Erangel'}</div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Match Info */}\r\n          <div className=\"grid md:grid-cols-2 gap-6 mb-6\">\r\n            <div className=\"card p-6\">\r\n              <h2 className=\"text-lg font-bold mb-4\">Match Details</h2>\r\n              <dl className=\"space-y-3\">\r\n                <div className=\"flex justify-between\">\r\n                  <dt className=\"text-dark-400\">Game</dt>\r\n                  <dd className=\"font-medium capitalize\">{match.gameType?.replace('_', ' ')}</dd>\r\n                </div>\r\n                <div className=\"flex justify-between\">\r\n                  <dt className=\"text-dark-400\">Match Type</dt>\r\n                  <dd className=\"font-medium capitalize\">{match.matchType?.replace('_', ' ')}</dd>\r\n                </div>\r\n                <div className=\"flex justify-between\">\r\n                  <dt className=\"text-dark-400\">Scheduled</dt>\r\n                  <dd className=\"font-medium\">{new Date(match.scheduledAt).toLocaleString()}</dd>\r\n                </div>\r\n                <div className=\"flex justify-between\">\r\n                  <dt className=\"text-dark-400\">Per Kill</dt>\r\n                  <dd className=\"font-medium\">‚Çπ{match.perKillPrize || 0}</dd>\r\n                </div>\r\n              </dl>\r\n            </div>\r\n\r\n            <div className=\"card p-6\">\r\n              <h2 className=\"text-lg font-bold mb-4\">Prize Distribution</h2>\r\n              <div className=\"space-y-2\">\r\n                {match.prizeDistribution?.length > 0 ? (\r\n                  match.prizeDistribution.map((prize, idx) => (\r\n                    <div key={idx} className=\"flex justify-between items-center\">\r\n                      <span className=\"text-dark-400\">\r\n                        {idx === 0 ? 'ü•á' : idx === 1 ? 'ü•à' : idx === 2 ? 'ü•â' : `#${idx + 1}`}{' '}\r\n                        {prize.label || `Rank ${prize.position || idx + 1}`}\r\n                      </span>\r\n                      <span className=\"font-bold text-gaming-green\">‚Çπ{prize.prize ?? prize.amount ?? 0}</span>\r\n                    </div>\r\n                  ))\r\n                ) : (\r\n                  <p className=\"text-dark-400\">Winner takes all!</p>\r\n                )}\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Room Credentials (if joined and credentials available) */}\r\n          {isJoined && roomCredentials?.roomId && (\r\n            <div className=\"card p-6 mb-6 border-2 border-gaming-green/50 bg-gradient-to-r from-gaming-green/10 to-transparent\">\r\n              <div className=\"flex items-center justify-between mb-4\">\r\n                <h2 className=\"text-lg font-bold text-gaming-green flex items-center gap-2\">\r\n                  <span className=\"text-2xl\">üéÆ</span> Room Credentials\r\n                </h2>\r\n                <span className=\"text-xs bg-gaming-green/20 text-gaming-green px-2 py-1 rounded\">READY</span>\r\n              </div>\r\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n                <div className=\"bg-dark-800 rounded-lg p-4\">\r\n                  <div className=\"text-dark-400 text-sm mb-1\">Room ID</div>\r\n                  <div className=\"flex items-center justify-between\">\r\n                    <div className=\"text-2xl font-mono font-bold tracking-wider\">{roomCredentials.roomId}</div>\r\n                    <button\r\n                      onClick={() => copyToClipboard(roomCredentials.roomId, 'roomId')}\r\n                      className=\"ml-2 p-2 hover:bg-dark-700 rounded transition-colors\"\r\n                    >\r\n                      {copied === 'roomId' ? (\r\n                        <span className=\"text-gaming-green text-sm\">‚úì Copied</span>\r\n                      ) : (\r\n                        <svg className=\"w-5 h-5 text-dark-400\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n                          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z\" />\r\n                        </svg>\r\n                      )}\r\n                    </button>\r\n                  </div>\r\n                </div>\r\n                <div className=\"bg-dark-800 rounded-lg p-4\">\r\n                  <div className=\"text-dark-400 text-sm mb-1\">Password</div>\r\n                  <div className=\"flex items-center justify-between\">\r\n                    <div className=\"text-2xl font-mono font-bold tracking-wider\">{roomCredentials.roomPassword}</div>\r\n                    <button\r\n                      onClick={() => copyToClipboard(roomCredentials.roomPassword, 'roomPassword')}\r\n                      className=\"ml-2 p-2 hover:bg-dark-700 rounded transition-colors\"\r\n                    >\r\n                      {copied === 'roomPassword' ? (\r\n                        <span className=\"text-gaming-green text-sm\">‚úì Copied</span>\r\n                      ) : (\r\n                        <svg className=\"w-5 h-5 text-dark-400\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n                          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z\" />\r\n                        </svg>\r\n                      )}\r\n                    </button>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n              <div className=\"mt-4 text-center text-dark-400 text-sm\">\r\n                Join the room and start the match. Good luck! üèÜ\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {/* Waiting for opponent (Challenge matches) */}\r\n          {isJoined && !roomCredentials?.roomId && match.matchType === 'tdm' && !isFull && (\r\n            <div className=\"card p-6 mb-6 border border-yellow-500/30 bg-yellow-500/5\">\r\n              <div className=\"flex items-center gap-3\">\r\n                <div className=\"w-10 h-10 bg-yellow-500/20 rounded-full flex items-center justify-center animate-pulse\">\r\n                  <span className=\"text-xl\">‚è≥</span>\r\n                </div>\r\n                <div>\r\n                  <h3 className=\"font-bold text-yellow-400\">Waiting for Opponent</h3>\r\n                  <p className=\"text-dark-400 text-sm\">Room credentials will be revealed once an opponent accepts the challenge</p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {/* Waiting for credentials (regular matches) */}\r\n          {isJoined && !roomCredentials?.roomId && match.matchType !== 'tdm' && match.status === 'upcoming' && (\r\n            <div className=\"card p-6 mb-6 border border-yellow-500/30 bg-yellow-500/5\">\r\n              <div className=\"flex items-center gap-3\">\r\n                <div className=\"w-10 h-10 bg-yellow-500/20 rounded-full flex items-center justify-center\">\r\n                  <span className=\"text-xl\">‚è≥</span>\r\n                </div>\r\n                <div>\r\n                  <h3 className=\"font-bold\">Waiting for Room Credentials</h3>\r\n                  <p className=\"text-dark-400 text-sm\">Room ID and Password will be shared before the match starts</p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {/* Action Buttons */}\r\n          <div className=\"card p-6\">\r\n            {error && (\r\n              <div className=\"bg-red-500/10 border border-red-500/20 text-red-400 px-4 py-3 rounded-lg mb-4\">\r\n                {error}\r\n              </div>\r\n            )}\r\n\r\n            {(match.status === 'upcoming' || match.status === 'registration_open') && (\r\n              <>\r\n                {isCreator ? (\r\n                  <div className=\"space-y-4\">\r\n                    <div className=\"flex items-center justify-between p-4 bg-gaming-purple/10 border border-gaming-purple/30 rounded-lg\">\r\n                      <div>\r\n                        <div className=\"font-bold text-gaming-purple\">üëë You created this challenge</div>\r\n                        <p className=\"text-dark-400 text-sm\">Waiting for an opponent to accept...</p>\r\n                      </div>\r\n                      <div className=\"text-right\">\r\n                        <div className=\"text-sm text-dark-400\">Invested</div>\r\n                        <div className=\"font-bold text-gaming-orange\">‚Çπ{(match.creationFee || 0) + (match.prizePool || 0)}</div>\r\n                      </div>\r\n                    </div>\r\n\r\n                    {canCancel && (\r\n                      <button\r\n                        onClick={handleCancelChallenge}\r\n                        className=\"w-full py-3 bg-red-500/10 border border-red-500/30 text-red-400 rounded-lg hover:bg-red-500/20 transition-colors font-medium\"\r\n                      >\r\n                        üö´ Cancel Challenge & Get Refund\r\n                      </button>\r\n                    )}\r\n\r\n                    {!canCancel && match.isChallenge && (match.filledSlots > 1 || match.joinedUsers?.length > 1) && (\r\n                      <div className=\"text-center text-yellow-400 text-sm p-3 bg-yellow-500/10 border border-yellow-500/30 rounded-lg\">\r\n                        ‚ö†Ô∏è An opponent has joined. The match cannot be cancelled now.\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                ) : isJoined ? (\r\n                  <div className=\"flex items-center justify-between\">\r\n                    <div className=\"text-gaming-green font-medium\">‚úì You have joined this match</div>\r\n                    <button onClick={handleLeave} className=\"btn-secondary text-red-400 hover:text-red-300\">\r\n                      Leave Match\r\n                    </button>\r\n                  </div>\r\n                ) : (\r\n                  <button\r\n                    onClick={() => setShowJoinModal(true)}\r\n                    disabled={isFull}\r\n                    className=\"btn-primary w-full py-3 text-lg\"\r\n                  >\r\n                    {isFull ? 'Match Full' : `Join Match - ‚Çπ${match.entryFee || 'FREE'}`}\r\n                  </button>\r\n                )}\r\n              </>\r\n            )}\r\n\r\n            {match.status === 'live' && (\r\n              <div className=\"text-center py-4\">\r\n                <div className=\"text-gaming-green text-xl font-bold animate-pulse\">Match is LIVE!</div>\r\n              </div>\r\n            )}\r\n\r\n            {match.status === 'completed' && (\r\n              <div className=\"text-center py-4 text-dark-400\">\r\n                This match has ended\r\n              </div>\r\n            )}\r\n          </div>\r\n\r\n          {/* Match Chat */}\r\n          {isJoined && (\r\n            <div className=\"mb-6\">\r\n              <MatchChat matchId={params.id} isJoined={isJoined} />\r\n            </div>\r\n          )}\r\n        </div>\r\n      </main>\r\n\r\n      {/* Join Modal */}\r\n      {showJoinModal && (\r\n        <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4\">\r\n          <div className=\"card p-6 w-full max-w-md\">\r\n            <h2 className=\"text-xl font-bold mb-4\">Join Match</h2>\r\n            <form onSubmit={handleJoin} className=\"space-y-4\">\r\n              <div>\r\n                <label className=\"label\">In-Game ID</label>\r\n                <input\r\n                  type=\"text\"\r\n                  value={joinForm.inGameId}\r\n                  onChange={(e) => setJoinForm({ ...joinForm, inGameId: e.target.value })}\r\n                  className=\"input\"\r\n                  placeholder=\"Your BGMI ID\"\r\n                  required\r\n                />\r\n              </div>\r\n              <div>\r\n                <label className=\"label\">In-Game Name</label>\r\n                <input\r\n                  type=\"text\"\r\n                  value={joinForm.inGameName}\r\n                  onChange={(e) => setJoinForm({ ...joinForm, inGameName: e.target.value })}\r\n                  className=\"input\"\r\n                  placeholder=\"Your BGMI username\"\r\n                  required\r\n                />\r\n              </div>\r\n              <div className=\"flex gap-3\">\r\n                <button type=\"button\" onClick={() => setShowJoinModal(false)} className=\"btn-secondary flex-1\">\r\n                  Cancel\r\n                </button>\r\n                <button type=\"submit\" disabled={joining} className=\"btn-primary flex-1\">\r\n                  {joining ? 'Joining...' : 'Confirm Join'}\r\n                </button>\r\n              </div>\r\n            </form>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      <Footer />\r\n    </>\r\n  );\r\n}\r\n","'use client';\r\n\r\nimport { useState, useEffect, useRef } from 'react';\r\nimport { useAuth } from '@/context/AuthContext';\r\nimport { sendMessage, getMatchMessages } from '@/lib/api';\r\nimport { formatDate } from '@/lib/utils';\r\nimport { io } from 'socket.io-client';\r\n\r\nexport default function MatchChat({ matchId, isJoined = false }) {\r\n    const { user } = useAuth();\r\n    const [messages, setMessages] = useState([]);\r\n    const [newMessage, setNewMessage] = useState('');\r\n    const [loading, setLoading] = useState(true);\r\n    const [sending, setSending] = useState(false);\r\n    const [socket, setSocket] = useState(null);\r\n    const messagesEndRef = useRef(null);\r\n\r\n    useEffect(() => {\r\n        if (matchId && user) {\r\n            fetchMessages();\r\n            connectSocket();\r\n        } else {\r\n            setLoading(false);\r\n        }\r\n\r\n        return () => {\r\n            if (socket) {\r\n                socket.emit('leave_match', matchId);\r\n                socket.disconnect();\r\n            }\r\n        };\r\n    }, [matchId, user]);\r\n\r\n    useEffect(() => {\r\n        scrollToBottom();\r\n    }, [messages]);\r\n\r\n    const connectSocket = () => {\r\n        const token = localStorage.getItem('token');\r\n        if (!token) return;\r\n\r\n        const socketInstance = io(process.env.NEXT_PUBLIC_API_URL?.replace('/api', '') || 'http://localhost:5000', {\r\n            auth: { token }\r\n        });\r\n\r\n        socketInstance.on('connect', () => {\r\n            socketInstance.emit('join_match', matchId);\r\n        });\r\n\r\n        socketInstance.on('new_message', (message) => {\r\n            if (message.match === matchId || message.matchId === matchId) {\r\n                setMessages(prev => {\r\n                    if (prev.some(m => m._id === message._id)) {\r\n                        return prev;\r\n                    }\r\n                    return [...prev, message];\r\n                });\r\n            }\r\n        });\r\n\r\n        setSocket(socketInstance);\r\n    };\r\n\r\n    const fetchMessages = async () => {\r\n        try {\r\n            const data = await getMatchMessages(matchId);\r\n            setMessages(data.messages || []);\r\n        } catch (err) {\r\n            console.error('Failed to fetch messages:', err);\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    const scrollToBottom = () => {\r\n        messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });\r\n    };\r\n\r\n    const handleSend = async (e) => {\r\n        e.preventDefault();\r\n        if (!newMessage.trim() || sending) return;\r\n\r\n        const messageContent = newMessage.trim();\r\n        setNewMessage('');\r\n        setSending(true);\r\n\r\n        try {\r\n            await sendMessage(matchId, null, messageContent);\r\n            // Message will be added via socket, but add optimistically\r\n            setMessages(prev => [...prev, {\r\n                _id: Date.now(),\r\n                content: messageContent,\r\n                sender: { _id: user._id, name: user.name },\r\n                createdAt: new Date().toISOString()\r\n            }]);\r\n        } catch (err) {\r\n            console.error('Failed to send message:', err);\r\n            setNewMessage(messageContent); // Restore message on error\r\n        } finally {\r\n            setSending(false);\r\n        }\r\n    };\r\n\r\n    if (!user) {\r\n        return (\r\n            <div className=\"bg-gray-900/50 backdrop-blur-xl rounded-xl p-6 border border-gray-800\">\r\n                <h3 className=\"text-lg font-bold text-white mb-4\">Match Chat</h3>\r\n                <p className=\"text-gray-400 text-center py-8\">Login to participate in the chat</p>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    if (!isJoined) {\r\n        return (\r\n            <div className=\"bg-gray-900/50 backdrop-blur-xl rounded-xl p-6 border border-gray-800\">\r\n                <h3 className=\"text-lg font-bold text-white mb-4\">Match Chat</h3>\r\n                <p className=\"text-gray-400 text-center py-8\">Join the match to access the chat</p>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div className=\"bg-gray-900/50 backdrop-blur-xl rounded-xl border border-gray-800 flex flex-col h-96\">\r\n            {/* Header */}\r\n            <div className=\"px-4 py-3 border-b border-gray-800\">\r\n                <h3 className=\"font-bold text-white flex items-center gap-2\">\r\n                    üí¨ Match Chat\r\n                    <span className=\"w-2 h-2 bg-green-400 rounded-full animate-pulse\" />\r\n                </h3>\r\n            </div>\r\n\r\n            {/* Messages */}\r\n            <div className=\"flex-1 overflow-y-auto p-4 space-y-3\">\r\n                {loading ? (\r\n                    <div className=\"flex justify-center py-8\">\r\n                        <div className=\"w-6 h-6 border-2 border-cyan-500 border-t-transparent rounded-full animate-spin\" />\r\n                    </div>\r\n                ) : messages.length === 0 ? (\r\n                    <p className=\"text-gray-400 text-center py-8\">No messages yet. Start the conversation!</p>\r\n                ) : (\r\n                    messages.map((message, index) => {\r\n                        const isOwn = message.sender?._id === user._id;\r\n                        return (\r\n                            <div\r\n                                key={message._id || index}\r\n                                className={`flex ${isOwn ? 'justify-end' : 'justify-start'}`}\r\n                            >\r\n                                <div className={`max-w-[80%] ${isOwn ? 'order-2' : ''}`}>\r\n                                    {!isOwn && (\r\n                                        <p className=\"text-xs text-gray-400 mb-1\">{message.sender?.name || 'Unknown'}</p>\r\n                                    )}\r\n                                    <div className={`px-4 py-2 rounded-2xl ${isOwn\r\n                                        ? 'bg-gradient-to-r from-cyan-500 to-purple-500 text-white rounded-br-sm'\r\n                                        : 'bg-gray-800 text-white rounded-bl-sm'\r\n                                        }`}>\r\n                                        <p className=\"text-sm\">{message.content}</p>\r\n                                    </div>\r\n                                    <p className=\"text-xs text-gray-500 mt-1\">\r\n                                        {new Date(message.createdAt).toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}\r\n                                    </p>\r\n                                </div>\r\n                            </div>\r\n                        );\r\n                    })\r\n                )}\r\n                <div ref={messagesEndRef} />\r\n            </div>\r\n\r\n            {/* Input */}\r\n            <form onSubmit={handleSend} className=\"p-3 border-t border-gray-800\">\r\n                <div className=\"flex gap-2\">\r\n                    <input\r\n                        type=\"text\"\r\n                        value={newMessage}\r\n                        onChange={(e) => setNewMessage(e.target.value)}\r\n                        placeholder=\"Type a message...\"\r\n                        maxLength={500}\r\n                        className=\"flex-1 px-4 py-2 bg-gray-800 border border-gray-700 rounded-xl text-white text-sm focus:outline-none focus:border-cyan-500\"\r\n                    />\r\n                    <button\r\n                        type=\"submit\"\r\n                        disabled={!newMessage.trim() || sending}\r\n                        className=\"px-4 py-2 bg-gradient-to-r from-cyan-500 to-purple-500 text-white rounded-xl font-semibold disabled:opacity-50\"\r\n                    >\r\n                        {sending ? '...' : 'Send'}\r\n                    </button>\r\n                </div>\r\n            </form>\r\n        </div>\r\n    );\r\n}\r\n"],"names":[],"mappings":"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"}