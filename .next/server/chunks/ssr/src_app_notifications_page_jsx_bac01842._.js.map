{"version":3,"sources":["../../../../src/app/notifications/page.jsx"],"sourcesContent":["'use client';\r\n\r\nimport { useState, useEffect } from 'react';\r\nimport { useRouter } from 'next/navigation';\r\nimport { useAuth } from '@/context/AuthContext';\r\nimport { api } from '@/lib/api';\r\nimport Navbar from '@/components/layout/Navbar';\r\nimport Footer from '@/components/layout/Footer';\r\n\r\nexport default function NotificationsPage() {\r\n  const router = useRouter();\r\n  const { isAuthenticated, loading: authLoading } = useAuth();\r\n  const [notifications, setNotifications] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [filter, setFilter] = useState('all'); // all, unread\r\n\r\n  useEffect(() => {\r\n    if (!authLoading && !isAuthenticated) {\r\n      router.push('/login');\r\n    }\r\n  }, [authLoading, isAuthenticated, router]);\r\n\r\n  useEffect(() => {\r\n    if (isAuthenticated) {\r\n      fetchNotifications();\r\n    }\r\n  }, [isAuthenticated]);\r\n\r\n  const fetchNotifications = async () => {\r\n    try {\r\n      const data = await api.getNotifications();\r\n      setNotifications(data.notifications || []);\r\n    } catch (err) {\r\n      console.error('Failed to fetch notifications');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const markAsRead = async (id) => {\r\n    try {\r\n      await api.markNotificationRead(id);\r\n      setNotifications(notifications.map(n => \r\n        n._id === id ? { ...n, read: true } : n\r\n      ));\r\n    } catch (err) {\r\n      console.error('Failed to mark as read');\r\n    }\r\n  };\r\n\r\n  const markAllAsRead = async () => {\r\n    try {\r\n      await api.markAllNotificationsRead();\r\n      setNotifications(notifications.map(n => ({ ...n, read: true })));\r\n    } catch (err) {\r\n      console.error('Failed to mark all as read');\r\n    }\r\n  };\r\n\r\n  const getNotificationIcon = (type) => {\r\n    const icons = {\r\n      match_joined: 'ðŸŽ®',\r\n      match_started: 'ðŸš€',\r\n      match_completed: 'ðŸ†',\r\n      match_cancelled: 'âŒ',\r\n      payment_received: 'ðŸ’°',\r\n      withdrawal_completed: 'ðŸ’¸',\r\n      withdrawal_failed: 'âš ï¸',\r\n      referral_bonus: 'ðŸŽ',\r\n      kyc_approved: 'âœ…',\r\n      kyc_rejected: 'âŒ',\r\n      announcement: 'ðŸ“¢',\r\n      default: 'ðŸ””',\r\n    };\r\n    return icons[type] || icons.default;\r\n  };\r\n\r\n  const filteredNotifications = filter === 'unread' \r\n    ? notifications.filter(n => !n.read)\r\n    : notifications;\r\n\r\n  const unreadCount = notifications.filter(n => !n.read).length;\r\n\r\n  if (authLoading || (!isAuthenticated && !loading)) {\r\n    return (\r\n      <>\r\n        <Navbar />\r\n        <div className=\"min-h-screen bg-dark-900 flex items-center justify-center\">\r\n          <div className=\"w-12 h-12 border-4 border-primary-500 border-t-transparent rounded-full animate-spin\"></div>\r\n        </div>\r\n      </>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <Navbar />\r\n      <main className=\"min-h-screen bg-dark-900 py-8\">\r\n        <div className=\"container mx-auto px-4 max-w-2xl\">\r\n          {/* Header */}\r\n          <div className=\"flex justify-between items-center mb-6\">\r\n            <div>\r\n              <h1 className=\"text-2xl font-bold\">Notifications</h1>\r\n              {unreadCount > 0 && (\r\n                <p className=\"text-dark-400 text-sm\">{unreadCount} unread</p>\r\n              )}\r\n            </div>\r\n            {unreadCount > 0 && (\r\n              <button onClick={markAllAsRead} className=\"btn-secondary text-sm\">\r\n                Mark all as read\r\n              </button>\r\n            )}\r\n          </div>\r\n\r\n          {/* Filters */}\r\n          <div className=\"flex gap-2 mb-6\">\r\n            <button\r\n              onClick={() => setFilter('all')}\r\n              className={`px-4 py-2 rounded-lg text-sm ${\r\n                filter === 'all' ? 'bg-primary-600 text-white' : 'bg-dark-700 text-dark-300'\r\n              }`}\r\n            >\r\n              All\r\n            </button>\r\n            <button\r\n              onClick={() => setFilter('unread')}\r\n              className={`px-4 py-2 rounded-lg text-sm ${\r\n                filter === 'unread' ? 'bg-primary-600 text-white' : 'bg-dark-700 text-dark-300'\r\n              }`}\r\n            >\r\n              Unread ({unreadCount})\r\n            </button>\r\n          </div>\r\n\r\n          {/* Notifications List */}\r\n          {loading ? (\r\n            <div className=\"flex justify-center py-12\">\r\n              <div className=\"w-8 h-8 border-4 border-primary-500 border-t-transparent rounded-full animate-spin\"></div>\r\n            </div>\r\n          ) : filteredNotifications.length === 0 ? (\r\n            <div className=\"card p-12 text-center\">\r\n              <div className=\"text-4xl mb-4\">ðŸ””</div>\r\n              <h2 className=\"text-xl font-bold mb-2\">No notifications</h2>\r\n              <p className=\"text-dark-400\">\r\n                {filter === 'unread' ? 'You have no unread notifications' : 'You have no notifications yet'}\r\n              </p>\r\n            </div>\r\n          ) : (\r\n            <div className=\"space-y-3\">\r\n              {filteredNotifications.map((notification) => (\r\n                <div\r\n                  key={notification._id}\r\n                  onClick={() => !notification.read && markAsRead(notification._id)}\r\n                  className={`card p-4 cursor-pointer transition-colors ${\r\n                    notification.read ? 'bg-dark-800' : 'bg-dark-700 border-l-4 border-primary-500'\r\n                  }`}\r\n                >\r\n                  <div className=\"flex gap-4\">\r\n                    <div className=\"text-2xl\">{getNotificationIcon(notification.type)}</div>\r\n                    <div className=\"flex-1\">\r\n                      <div className=\"flex justify-between items-start\">\r\n                        <h3 className={`font-medium ${notification.read ? 'text-dark-300' : 'text-white'}`}>\r\n                          {notification.title}\r\n                        </h3>\r\n                        <span className=\"text-dark-500 text-xs\">\r\n                          {new Date(notification.createdAt).toLocaleDateString()}\r\n                        </span>\r\n                      </div>\r\n                      <p className=\"text-dark-400 text-sm mt-1\">{notification.message}</p>\r\n                      {notification.link && (\r\n                        <a href={notification.link} className=\"text-primary-400 text-sm mt-2 inline-block hover:underline\">\r\n                          View details â†’\r\n                        </a>\r\n                      )}\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          )}\r\n        </div>\r\n      </main>\r\n      <Footer />\r\n    </>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}